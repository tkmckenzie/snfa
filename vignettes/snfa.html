<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Introduction to snfa</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to snfa</h1>



<p>Economic efficiency analyses consider two separate measures of efficiency:</p>
<ul>
<li><p>Technical efficiency: How effectively inputs are transformed into outputs</p></li>
<li><p>Allocative inefficiency: How effectively the production plan maximizes profit</p></li>
</ul>
<p>Traditionally, data envelopment analysis (DEA) and stochastic frontier analysis (SFA) have been used to estimate technical efficiency. Both methods estimate a production frontier that quantifies the maximum quantity of output producible by a given bundle of inputs. The observed output of a decision making unit (DMU) can be compared to the frontier to arrive at an estimate of efficiency. SFA assumes efficiency is randomly determined and follows a distribution common across DMUs (Aigner et al. 1977). A standard stochastic frontier model takes the form <span class="math display">\[y_i = f(X_i) - \delta_i + \varepsilon_i,\]</span> where <span class="math inline">\(i\)</span> indexes the DMU, <span class="math inline">\(y_i\)</span> is log-output, <span class="math inline">\(f\)</span> is a transformation function, <span class="math inline">\(X_i\)</span> are inputs, <span class="math inline">\(\delta_i &gt; 0\)</span> is log-efficiency, and <span class="math inline">\(\varepsilon_i\)</span> is observational error. The log-efficiency term <span class="math inline">\(\delta_i\)</span> may be assumed to follow a half-normal, exponential, or other positively-defined distribution. Traditionally, SFA uses a parametric approximation for <span class="math inline">\(f\)</span>.</p>
<p>DEA, on the other hand, assumes the production frontier is deterministic and defined by highest observed output (conditional on inputs used). The estimated frontier is piecewise-linear connecting maximum observed output conditional on inputs used while enforcing monotonicity and concavity constraints (as well as constraints on returns to scale, if those are specified). An example DEA frontier using variable returns to scale is shown below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="co"># library(rDEA) #rDEA not installing with travis-ci, dea method below is included in snfa</span>
<span class="kw">data</span>(univariate)

dea.fit &lt;-<span class="st"> </span><span class="kw">dea</span>(univariate<span class="op">$</span>x, univariate<span class="op">$</span>y,
               univariate<span class="op">$</span>x, univariate<span class="op">$</span>y,
               <span class="dt">model =</span> <span class="st">&quot;output&quot;</span>,
               <span class="dt">RTS =</span> <span class="st">&quot;variable&quot;</span>)
univariate<span class="op">$</span>frontier &lt;-<span class="st"> </span>univariate<span class="op">$</span>y <span class="op">/</span><span class="st"> </span>dea.fit<span class="op">$</span>thetaOpt
<span class="kw">ggplot</span>(univariate, <span class="kw">aes</span>(x, y)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> frontier), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Allocative efficiency is evaluated by checking whether DMUs’ first-order condition for profit-maximization is satisifed. Specifically, if DMUs are price-takers in input and output markets, first-order conditions are given by <span class="math display">\[\frac{\partial f(X_i)}{\partial x^j} = \frac{w_i^j}{p_i},\]</span> where superscripts index inputs, <span class="math inline">\(w_i^j\)</span> is the cost of input <span class="math inline">\(j\)</span> to DMU <span class="math inline">\(i\)</span>, and <span class="math inline">\(p_i\)</span> is the price of output for DMU <span class="math inline">\(i\)</span>. If efficiency is multiplicative, so that <span class="math inline">\(f(X_i) = p(X_i)\delta_i\)</span> for a frontier function <span class="math inline">\(p\)</span>, then the first-order condition can be expressed as <span class="math display">\[\delta_i\frac{\partial p(X_i)}{\partial x^j} = \frac{w_i^j}{p_i}.\]</span> Empircally, log-overallocation of input <span class="math inline">\(j\)</span> by DMU <span class="math inline">\(i\)</span> can be estimated by <span class="math display">\[\log\left(w_i^j\right) + \log\left(p_i\right) - \log\left(\delta_i\frac{\partial p(X_i)}{\partial x^j}\right).\]</span> If this quantity is positive, DMU <span class="math inline">\(i\)</span> used more of input <span class="math inline">\(j\)</span> than would be profit maximizing.</p>
<p>As detailed above, to estimate allocative inefficiency one needs to be able to estimate marginal input productivities, which are derivatives of the production function/frontier. Since DEA is piecewise-linear, there can be points on the estimated frontier where the derivative is undefined. Using the previous example, the points in blue in the following plot have undefined derivatives.</p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Thus, DEA is inappropriate for estimating allocative inefficiency.</p>
<p>Smooth non-parametric frontier analysis (SNFA) is a smooth analogue of DEA (Racine et al. 2009). It uses constrained kernel smoothing that ensures the estimated frontier lies above observed output for each observation, as well as imposing monotonicity or concavity constraints, if specified. An increasing, concave boundary is fit below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(univariate<span class="op">$</span>x)
y &lt;-<span class="st"> </span>univariate<span class="op">$</span>y

N.fit &lt;-<span class="st"> </span><span class="dv">100</span>
X.fit &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">seq</span>(<span class="kw">min</span>(X), <span class="kw">max</span>(X), <span class="dt">length.out =</span> N.fit))

<span class="co">#Reflect data for fitting</span>
reflected.data &lt;-<span class="st"> </span><span class="kw">reflect.data</span>(X, y)
X.eval &lt;-<span class="st"> </span>reflected.data<span class="op">$</span>X
y.eval &lt;-<span class="st"> </span>reflected.data<span class="op">$</span>y

frontier.mc &lt;-<span class="st"> </span><span class="kw">fit.boundary</span>(X.eval, y.eval, 
                            <span class="dt">X.bounded =</span> X, <span class="dt">y.bounded =</span> y,
                            <span class="dt">X.constrained =</span> X.fit,
                            <span class="dt">X.fit =</span> X.fit,
                            <span class="dt">method =</span> <span class="st">&quot;mc&quot;</span>)

frontier.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> X.fit,
                          <span class="dt">y =</span> frontier.mc<span class="op">$</span>y.fit)
<span class="kw">ggplot</span>(univariate, <span class="kw">aes</span>(x, y)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> frontier.df, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">slope.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> X.fit,
                       <span class="dt">slope =</span> frontier.mc<span class="op">$</span>gradient.fit)
<span class="kw">ggplot</span>(slope.df, <span class="kw">aes</span>(x, slope)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>A more in-depth example examining different constraints can be found in the example for <code>fit.boundary</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">example</span>(<span class="st">&quot;fit.boundary&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEgCAMAAABb4lATAAAAzFBMVEUAAAAAADoAAGYAOpAAZrYAujgzMzM6AAA6ADo6AGY6OpA6kJA6kNtNTU1NTW5NTY5NbqtNjshhnP9mAABmADpmAGZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQkGaQtpCQ2/+rbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC2/7a2///Ijk3I///bkDrb///kq27k///r6+vy8vL4dm3/tmb/yI7/25D/5Kv//7b//8j//9v//+T///8Bol2HAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQMElEQVR4nO2dC3vVuBGGDcTAtpxd6rRh2w29HLqbbC9QQoCzTkgg/v//qZZ8t+72yBrpzPeQnOTkyzDWm7FkW5azipS0stAJkPyKACcuApy4CHDiIsCJiwAnrmWAD1zti6Xc3F6DI0plYgdmy0WAEQUHZstFgBEFB2bLRYARBQdmy0WAEQUHZstFgBEFB2bLRYARBQdmy0WAEQUHZstFgBEFB2bLRYARBQdmy0WAEQUHZstFgMMFL+Z2YLZcBDhY8EKwA7PlIsChgheiHZgtFwEOFLyQ2IHZchHgMME7vgQ4vNtH8J4vAQ7vhg9eDHwJcHg3ePBi/A0BDu4GDj6Ubzm3A7Pl0gB+uNx9/7aqvr7evfzcvxDgle6hfEvBvjHgq311+/Lzw+W++vSHqn0hwCvdc74BAX/924fu5e7PH9oXArzOPeyeS4l9W8B3P/2b7aLvfvpcff3r2/alfv9pLR+ZHIOK7otys/9SA/jVntGt99KMbPvS/gz8L3utPY5Uuvrty/cQtoLHpTtUMAFe6m75jvEG7YP/wZFSHwwVvOE7xRt6FF3X7cPleTOKPqdR9Cp3y3f0Tj63bwy4PvL94QMdBwMFn/PN81ywbwxYI8ANh7GjT2XGt6V7IMAI3BDBe75Zlo3xEmAEboDgnG/Z8M17vBw2AQ7uXh+84cs+1XQZVa6MiQCHd4MA5kdHjG5GgP0H3ziVoilfvmse+BJgLO61wRu+44FVK+qDcbhXBud8R12vxg7MlosAew7O+E77XrUdmC0XAfYbvGB4u/7WZAdmy0WAvQYv2qNeArzSjjOVPC+6k5MqvgQ4vHtp8LrnLUqdUwgOzJaLAHsKzvBa8CXA4d0LgrOety5f1W5ZFRyYLRcBhg/eDJsL5bhKGRyYLRcBhra3ZyQt+RLg8G4ne55zN+frHByYLRcBhrSz6uXukgDD2lGkknez6Ep7vgQ4vNvS3l0uqg4lOwFNFQxqD5xKno9m0XV87QgT4OBuo316qbc8EGB4e8BUZlfyy4pPwSLAsPZgqcwnapSHqpkiS30wqD1MKrkwD6ecrcDhFhyYLRcBXmyXzLJiFxfsj5CE4MBsuQjwQrsEb8/XhTBOwEevPJe8yW7bLyoOeOt81KIKXmCXVW9bvw7jZzE4MFsuAuxsl+Ntbk2pAVfUB3uwb5aKOHBu1fFdExyYLRcBdrAr6bYLMwhLuDvmAsyWiwBb25V0u3U3xCXcHXMBZstFgC3tarz9ffsE2J/ddyoavDO+BNiL3W8qOrxzvgTYi92nW4tX4EuAvdj9uWu8Ons/tZ0Axwi4OS7S2EW+BNiL3Yc7H2ZZqSThS4C92OHdo55XaZfxJcBe7NDuycBKZZfyJcBe7LDu2bhZYR/xHV9fIMA+7JBu4bBIbp/yHQgTYB92OLfkqFdqH++fCfDKDd/MLb9cJLMPt3YHBHzz+H335ZfnFwTY5FadspLYJ3wPofpgAuziVp+RFO0zvitSIcAbuXUnnAW7ji884C/Pf3mWZS++1J/Oqurbmyw7qd+9P80e/VwDZt/XLwRY51bP1JDaR0urbAL42ZOP1XXGPj1+/+3NScU+7k9f1B/N99X1k48EWO3W0xWD6/n6AHzWfXp+wffK9Sf+et2+3p+eEWCV24h3HtzA18cu+mL4dFMXMnu95q/fvb/mI/h6B06AZW7DvlkSvDTx3Rowe61okCV1W9GdBp+sbBYE8KOLYRfNXh9dEGC52xbvOLgFX8+Ah0HWSTvIqku4pkyAZ257vEPw0oavZ8DSw6S6ignwxO2Ctw8+W3hyM8DrdIyA3fB2wS35RgWYPdc9tWcX5oZZdKrg84VjkwD8abfnkPnTR/cpPH20X6vMNbg135gA3/3l7/sqpecHm2fRqYLb840I8MOv/73cV8ITwJ/W8pGJd0nvyrdTOfu+WJfJltIA/nTO9su3LznZ9qX90ZK/1bAVPDln5ZqKsHC7biWdaCqYP/1bUsExArabRafQ/KHsU77C/fzRAP60YzpPoA+2nEWnUCnYZ3xnhKMBXDWHSQ+X580o+jzSUbTtLDq5WPnO7JP98xaAf5MKCnDkx8HWs+jkKkX7tP+NG7BSSzYlBGDFOSvr2KVon4+vNuiDCbDcrb7Yaxu7FO3mlSgJsA+74NZeyreL3Y+eR3aLlUYJsA/7zG24nGATe3RwNNhtVpIlwD7sE7frLDqZxse+vd1qpWAC7MM+cjvPopNoem6js9utBE2Afdh7t/MsOonmp64IsO8Nt3ZbXsrXxhbPTLZ2y6XcNwb87Z8/Z9mLm/ojfcDWMzU0sUW8nd12qX4PgEtBI8BvTqovz07YFNrEATtMxFHGluFt7daPYti8gi/4x/0f5bPuUgHsNM9KEVuOt7HbP2qDAMPb7W5QMMRW4eV24QS0Y3A7OwGWKe8f+bkmthovs5suMBiC2+ZCgEW1tbs8lXbUorcTYMctgbL3u+aFqRjIdvZZB4wKsEkxA7ZZjE4V21y3g4QBFgEG3nCppIvRiUeMCjlkUgipaEsYMeD700eKO5jwAZ7gdeXmlEoh2mMFXFXvsqy9oRg34AbvCKu/VAqJPV7A/K5E1VlNNIA53mIm/pMFz+w1SP4kpKj7YIb4sfy8ZmjAvF3zEdCRu3nXjrB9KguehAQPeJXmgK/57cXvDDvqJZuyHnBNT0Q7dvOfW5SxbSrFkgflYK5gdrf4GfvixlDCSzZlPWBeoTo37xs1LsdUlj1HBTFgtuaD3W9tvOFMNbd8GNsoJiOztxvG61MZYiQD2F4bb/ihrOnmI6zCMHbkbn6mZWyTyuKnMBBgV3vZ4B0j1QFufpg14+zFqSx/CgMBdrOXQ/UOTLWAxz+WMzamMv0tAuxvwxneAz+rMWXaft2/pQJ8kDI2pCIeg81Ca8dwSQDeSAxvd2M+b9jZz2Xvyd6vGdv/p1pv1so+HIASreCyqd7+nLOkcIZqquRvD5rUsSYV2S59PoLTl3ASFbxkU9zcjG5hmkjnAPgwZqxMRXcWZaBLgFdvOC/ew+TISCp5H6xG0DKWp2IadNvx3X5GxzAvmi1vOL8eiBFwWbJrdLx6jc0pDa77nUJ2KltD9zAF7JqKk10FOBf0m2xe9Lc3Z9XN/CQzPsAMb79zHhoVcr9YKS5G6YOHA6yv4H5OlnTuOzrAJT/J0J3X6BvV0LqbHKpCX6oS7GsB/05yiQgZ4L58O6AjzsEBew++FjD+CublK3a+5rENAa4Bsz5YgIwJMC9fofM9WBQwAebzopGPoln5ys9rmIc3xwvYJDSAm/JV2I3DGwKMHfC0fIGDr3MT4PUbXnK+h3GpEuB0APP56sVs7AzcqpOdPAHeEnBzO0Ixv+gL26rTYVpkgFcpOOAGbyEcHBHgXlFXcFu+3fDKVx88PZAmwJsB5r1vIbnqa3feVx98HGxCmABvBbgfXc1le5lQF3wajABvD7gZPUvNBDgBwM3uuf1mxhMe8Ph/IMBbAJ7sngWgkH2wEJwAbwB42v2KFQvZqutiE+AlGz4bXvkFvM5NgBdsuDC8EnbJBDhmwKrh8+KB0PECZlM4VCvNBgOs4evtalLMpyrnU0CLAjdg5eGvR8ALT1XyXwoOOLIKtju9gQJw81sE2GlL1Hx99sEEWNTdq90O/tmFOr6qDYdwL+qDIwDMZlNea9ZWUQNmTwu++/Ete0Alf/roHuTpo7Z8kYyi8ffBbOGr3/9pCeBbhvNqD/v8YGu+SABvG3wRYIP0ffDw6O/hCeBPa1kGF1TWHw4325O4/AFmT4W+fcnJti/tDxb+ZdvXL1XwFoC/vj6vh1rzCl4O2IXvBoCtL1ilCvju1Z5RBuuDnfj6B2x/yTlRwA1fvpvmo+jzlaPoki0Uu2zDvbj1gJef2YQHvEpqwJ92THuo4+CycuIbGPCKGT7RANZpwaaUVW6z0q90w/24DQXs7SYLtR2YLddWgMtDw3e2Qp3dhpsF587EJQUIsFmc73hdBrBFu1e7p6lMUiTAtiqbh9PIWg+mnZa7Z6kM31If7AQ4508fGvbQuADrFxMgwCbxHXQ1ajl0gIV1bLdKJQnA0w6YC1cfbMiGAOvVLG3merPCdqNoAizKaVOaAsYL2Lg7IcBatXwRA0YTHJgtl3fAHV8CbLYDs+XyDbjsryARYKMdmC2Xf8DdJYbKiS8BBpJnwANfTK2KKJXIAY/4YmpVRKlED3i4BIyoVRGlEjfgcQFjalVEqUQOeDyHA1GrIkolasBlVuBcIBJRKjEDLrN8/KhmRK2KKJWIAZeHuoAJsIsdmC2XT8A5AXazA7Pl8gZ4zhdTqyJKJVrApTALGlGrIkolVsCleJcKolZFlEq8gF0fu73OToBV8gNYwhdTqyJKJVbA+udou254WDcBFlTKbjND1KqIUkEKWK+SlmnAIx8VLC1gTGWDKBWkFazdFDlfTK2KKJUoAcvv80bUqohSiRCwooAxtSqiVOIDLDsEXrvhYd0EeCJVAWNqVUSpRAdYWcCYWhVRKvEBVq6kg6hVEaUSG2B1AWNqVUSpRAdYvRQWolZFlEpkgDUFjKlVEaUSG2DNWnaIWhVRKnEBVh4irdzwsG4C3EtXwJhaFVEqUQHWFjCmVkWUSlyAtavJImpVRKnEBFhfwJhaFVEqMQE2LAeNqFURpRIRYP0OGlWrIkolIsCm9dwRtSqiVOIBbCpgTK2KKJVoABtGWOs2PKybADMZCxhTqyJKJRbAZr6YWhVRKgQ4vJsAW/HF1KqIUokEsM0j6xC1KqJU4gA8WS7Jw4aHdRNgu4WCEbUqolQIcHj3kQDWPJySAAMFDwn44XKvfrys1VLfiFoVUSpoAAM8IHr5hod1Hwfg4RHvT2v5yITkRbaAb192gJk2/ssO6z62CibA3oKHBEx98AbBQwJ+uDxXj6J9b3hY93EA1h0He9/wsO4jATzRxhse1n2MgJfI67EVBVeJAKccvCLAaQevCHDawastAZOCiAAnLgKcuAhw4iLAiWsLwHevdrt9VX3a7XY/fDDb3dRGnZxJhYzNUveROb9y02btJflWGwBmVxnvfnxbXe19RG+iTmcUQYpdCPeQ+S37i2mz9pd8tQngW5b71f7h17dGq7vaqNOrmYBif50eMr/6/j91tm3W3pJn2qgPrtup3g/xPTVw4CbqdD4CoFhlecmcEW2z9pY80zaA2dVktpeGr4U26nRGEZx4TC+ZM8Bt1r6S59oE8NfX5+1XvvphX0Vw2w9+oDNPqYLvXvWN4wuwr27s6rz/ygPgRPrgli8rhod/QW9GG3U6owhMzY7ZS+aMaJu1p+QbbQB4dDT5Pfx+qI3q51Cy3XH6yDyh42BSSBHgxEWAExcBTlwEOHER4MRFgBMXAU5cBDhxEeDElTTg60cX1f3pi9BpBFXSgKt3J+zfUSttwF+e//Ld+9BJhFXagKvr7Cx0CoGVOOB32ZHvoRMHfPP4f6dHXsJJA76v6d48Pu5OOGnA7558rL69Oe6ddNKASQQ4eRHgxEWAExcBTlwEOHER4MRFgBMXAU5cBDhx/R+Mlne7FXhsFwAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The function <code>allocative.efficiency</code> uses SNFA to fit a production frontier, then uses the frontier to derive estimates of marginal input productivities. Those marginal productivities are compared to ratio of input to output prices to arrive at an estimate of overallocation. The example in <code>allocative.efficiency</code> estimates overallocation of labor and capital in the U.S. using macroeconomic data. First, data is loaded and cleaned:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(USMacro)

USMacro &lt;-<span class="st"> </span>USMacro[<span class="kw">complete.cases</span>(USMacro),]

<span class="co">#Extract data</span>
X &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(USMacro[,<span class="kw">c</span>(<span class="st">&quot;K&quot;</span>, <span class="st">&quot;L&quot;</span>)])
y &lt;-<span class="st"> </span>USMacro<span class="op">$</span>Y

X.price &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(USMacro[,<span class="kw">c</span>(<span class="st">&quot;K.price&quot;</span>, <span class="st">&quot;L.price&quot;</span>)])
y.price &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">1e9</span>, <span class="kw">nrow</span>(USMacro)) <span class="co">#Price of $1 billion of output is $1 billion</span></code></pre></div>
<p>Then, the model is fit with <code>allocative.efficiency</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Run model</span>
efficiency.model &lt;-<span class="st"> </span><span class="kw">allocative.efficiency</span>(X, y,
                                          X.price, y.price,
                                          <span class="dt">X.constrained =</span> X,
                                          <span class="dt">model =</span> <span class="st">&quot;br&quot;</span>,
                                          <span class="dt">method =</span> <span class="st">&quot;mc&quot;</span>)</code></pre></div>
<p>Finally, results are plotted and average overallocation is estimated:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Plot technical/allocative efficiency over time</span>
<span class="kw">library</span>(ggplot2)

technical.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Year =</span> USMacro<span class="op">$</span>Year,
                           <span class="dt">Efficiency =</span> efficiency.model<span class="op">$</span>technical.efficiency)

<span class="kw">ggplot</span>(technical.df, <span class="kw">aes</span>(Year, Efficiency)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">allocative.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Year =</span> <span class="kw">rep</span>(USMacro<span class="op">$</span>Year, <span class="dt">times =</span> <span class="dv">2</span>),
                            <span class="dt">log.overallocation =</span> <span class="kw">c</span>(efficiency.model<span class="op">$</span>log.overallocation[,<span class="dv">1</span>],
                                                   efficiency.model<span class="op">$</span>log.overallocation[,<span class="dv">2</span>]),
                            <span class="dt">Variable =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;K&quot;</span>, <span class="st">&quot;L&quot;</span>), <span class="dt">each =</span> <span class="kw">nrow</span>(USMacro)))

<span class="kw">ggplot</span>(allocative.df, <span class="kw">aes</span>(Year, log.overallocation)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Variable))</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Estimate average overallocation across sample period</span>
lm.model &lt;-<span class="st"> </span><span class="kw">lm</span>(log.overallocation <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Variable, allocative.df)
<span class="kw">summary</span>(lm.model)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = log.overallocation ~ 0 + Variable, data = allocative.df)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; -0.43704 -0.18195 -0.08572  0.14338  0.61385 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;           Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; VariableK   2.0297     0.0465   43.65   &lt;2e-16 ***</span>
<span class="co">#&gt; VariableL  -0.8625     0.0465  -18.55   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.279 on 70 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.9698, Adjusted R-squared:  0.9689 </span>
<span class="co">#&gt; F-statistic:  1124 on 2 and 70 DF,  p-value: &lt; 2.2e-16</span></code></pre></div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Aigner D, Lovell CK, Schmidt P (1977). “Formulation and estimation of stochastic frontier production function models.” Journal of Econometrics, 6(1), 21-37.</p>
<p>Racine JS, Parmeter CF, Du P (2009). “Constrained nonparametric kernel regression: Estimation and inference.” Working paper.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
